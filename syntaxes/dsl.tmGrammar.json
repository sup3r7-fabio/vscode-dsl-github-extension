{
  "$schema": "https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json",
  "name": "GitHub Actions DSL",
  "scopeName": "source.github-actions-dsl",
  "fileTypes": ["dsl"],
  "patterns": [
    {
      "include": "#comments"
    },
    {
      "include": "#workflow-root"
    },
    {
      "include": "#strings"
    },
    {
      "include": "#numbers"
    },
    {
      "include": "#booleans"
    },
    {
      "include": "#variables"
    }
  ],
  "repository": {
    "comments": {
      "patterns": [
        {
          "name": "comment.line.number-sign.github-actions-dsl",
          "match": "(^|\\s)(#).*$",
          "captures": {
            "2": {
              "name": "punctuation.definition.comment.github-actions-dsl"
            }
          }
        }
      ]
    },
    "workflow-root": {
      "patterns": [
        {
          "name": "keyword.other.workflow.name.github-actions-dsl",
          "match": "^\\s*(name)\\s*(:)",
          "captures": {
            "1": {
              "name": "entity.name.tag.github-actions-dsl"
            },
            "2": {
              "name": "punctuation.separator.key-value.github-actions-dsl"
            }
          }
        },
        {
          "name": "keyword.other.workflow.on.github-actions-dsl",
          "match": "^\\s*(on)\\s*(:)",
          "captures": {
            "1": {
              "name": "entity.name.tag.github-actions-dsl"
            },
            "2": {
              "name": "punctuation.separator.key-value.github-actions-dsl"
            }
          }
        },
        {
          "name": "keyword.other.workflow.jobs.github-actions-dsl",
          "match": "^\\s*(jobs)\\s*(:)",
          "captures": {
            "1": {
              "name": "entity.name.tag.github-actions-dsl"
            },
            "2": {
              "name": "punctuation.separator.key-value.github-actions-dsl"
            }
          }
        },
        {
          "include": "#job-definition"
        }
      ]
    },
    "job-definition": {
      "patterns": [
        {
          "name": "keyword.other.job.runs-on.github-actions-dsl",
          "match": "^\\s*(runs-on)\\s*(:)",
          "captures": {
            "1": {
              "name": "entity.name.tag.github-actions-dsl"
            },
            "2": {
              "name": "punctuation.separator.key-value.github-actions-dsl"
            }
          }
        },
        {
          "name": "keyword.other.job.steps.github-actions-dsl",
          "match": "^\\s*(steps)\\s*(:)",
          "captures": {
            "1": {
              "name": "entity.name.tag.github-actions-dsl"
            },
            "2": {
              "name": "punctuation.separator.key-value.github-actions-dsl"
            }
          }
        },
        {
          "name": "keyword.other.job.strategy.github-actions-dsl",
          "match": "^\\s*(strategy)\\s*(:)",
          "captures": {
            "1": {
              "name": "entity.name.tag.github-actions-dsl"
            },
            "2": {
              "name": "punctuation.separator.key-value.github-actions-dsl"
            }
          }
        },
        {
          "name": "keyword.other.job.env.github-actions-dsl",
          "match": "^\\s*(env)\\s*(:)",
          "captures": {
            "1": {
              "name": "entity.name.tag.github-actions-dsl"
            },
            "2": {
              "name": "punctuation.separator.key-value.github-actions-dsl"
            }
          }
        },
        {
          "include": "#step-definition"
        }
      ]
    },
    "step-definition": {
      "patterns": [
        {
          "name": "keyword.other.step.name.github-actions-dsl",
          "match": "^\\s*(-\\s+)?(name)\\s*(:)",
          "captures": {
            "1": {
              "name": "punctuation.definition.list.github-actions-dsl"
            },
            "2": {
              "name": "entity.name.tag.github-actions-dsl"
            },
            "3": {
              "name": "punctuation.separator.key-value.github-actions-dsl"
            }
          }
        },
        {
          "name": "keyword.other.step.uses.github-actions-dsl",
          "match": "^\\s*(uses)\\s*(:)",
          "captures": {
            "1": {
              "name": "entity.name.tag.github-actions-dsl"
            },
            "2": {
              "name": "punctuation.separator.key-value.github-actions-dsl"
            }
          }
        },
        {
          "name": "keyword.other.step.run.github-actions-dsl",
          "match": "^\\s*(run)\\s*(:)",
          "captures": {
            "1": {
              "name": "entity.name.tag.github-actions-dsl"
            },
            "2": {
              "name": "punctuation.separator.key-value.github-actions-dsl"
            }
          }
        },
        {
          "name": "keyword.other.step.with.github-actions-dsl",
          "match": "^\\s*(with)\\s*(:)",
          "captures": {
            "1": {
              "name": "entity.name.tag.github-actions-dsl"
            },
            "2": {
              "name": "punctuation.separator.key-value.github-actions-dsl"
            }
          }
        },
        {
          "name": "keyword.other.step.if.github-actions-dsl",
          "match": "^\\s*(if)\\s*(:)",
          "captures": {
            "1": {
              "name": "entity.name.tag.github-actions-dsl"
            },
            "2": {
              "name": "punctuation.separator.key-value.github-actions-dsl"
            }
          }
        }
      ]
    },
    "strings": {
      "patterns": [
        {
          "name": "string.quoted.double.github-actions-dsl",
          "begin": "\"",
          "end": "\"",
          "patterns": [
            {
              "name": "constant.character.escape.github-actions-dsl",
              "match": "\\\\."
            },
            {
              "include": "#expression-interpolation"
            }
          ]
        },
        {
          "name": "string.quoted.single.github-actions-dsl",
          "begin": "'",
          "end": "'",
          "patterns": [
            {
              "name": "constant.character.escape.github-actions-dsl",
              "match": "\\\\."
            }
          ]
        },
        {
          "name": "string.unquoted.github-actions-dsl",
          "match": "[^\\s\\[\\]{},:\"']+",
          "patterns": [
            {
              "include": "#expression-interpolation"
            }
          ]
        }
      ]
    },
    "expression-interpolation": {
      "patterns": [
        {
          "name": "meta.interpolation.github-actions-dsl",
          "begin": "\\$\\{\\{",
          "end": "\\}\\}",
          "beginCaptures": {
            "0": {
              "name": "punctuation.definition.template-expression.begin.github-actions-dsl"
            }
          },
          "endCaptures": {
            "0": {
              "name": "punctuation.definition.template-expression.end.github-actions-dsl"
            }
          },
          "patterns": [
            {
              "include": "#expression-content"
            }
          ]
        }
      ]
    },
    "expression-content": {
      "patterns": [
        {
          "name": "variable.other.readwrite.github-actions-dsl",
          "match": "\\b(github|env|job|jobs|runner|steps|strategy|matrix|secrets|vars|inputs|needs)\\b"
        },
        {
          "name": "support.function.github-actions-dsl",
          "match": "\\b(contains|startsWith|endsWith|format|join|toJSON|fromJSON|hashFiles|success|always|cancelled|failure)\\b"
        },
        {
          "name": "string.quoted.single.expression.github-actions-dsl",
          "begin": "'",
          "end": "'"
        },
        {
          "name": "string.quoted.double.expression.github-actions-dsl",
          "begin": "\"",
          "end": "\""
        }
      ]
    },
    "numbers": {
      "patterns": [
        {
          "name": "constant.numeric.github-actions-dsl",
          "match": "\\b\\d+(\\.\\d+)?\\b"
        }
      ]
    },
    "booleans": {
      "patterns": [
        {
          "name": "constant.language.boolean.github-actions-dsl",
          "match": "\\b(true|false|yes|no|on|off)\\b"
        }
      ]
    },
    "variables": {
      "patterns": [
        {
          "name": "variable.other.github-actions-dsl",
          "match": "\\$[A-Za-z_][A-Za-z0-9_]*"
        }
      ]
    },
    "operators": {
      "patterns": [
        {
          "name": "keyword.operator.github-actions-dsl",
          "match": "(==|!=|&&|\\|\\||!|<|>|<=|>=)"
        }
      ]
    },
    "runner-labels": {
      "patterns": [
        {
          "name": "constant.other.runner.github-actions-dsl",
          "match": "\\b(ubuntu-latest|ubuntu-20\\.04|ubuntu-18\\.04|windows-latest|windows-2022|windows-2019|macos-latest|macos-12|macos-11|self-hosted)\\b"
        }
      ]
    },
    "action-references": {
      "patterns": [
        {
          "name": "string.other.action-ref.github-actions-dsl",
          "match": "([a-zA-Z0-9_.-]+/[a-zA-Z0-9_.-]+)(@[a-zA-Z0-9._-]+)?",
          "captures": {
            "1": {
              "name": "entity.name.function.action.github-actions-dsl"
            },
            "2": {
              "name": "constant.other.version.github-actions-dsl"
            }
          }
        }
      ]
    },
    "events": {
      "patterns": [
        {
          "name": "constant.language.event.github-actions-dsl",
          "match": "\\b(push|pull_request|schedule|workflow_dispatch|repository_dispatch|release|issues|issue_comment|pull_request_review|pull_request_review_comment|create|delete|fork|watch|star|gollum|page_build|public|wiki|deployment|deployment_status)\\b"
        }
      ]
    }
  }
}
